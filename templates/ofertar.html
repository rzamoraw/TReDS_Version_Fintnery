{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
  <h2>
    {% if oferta is defined %}Editar oferta{% else %}Ofertar sobre Factura{% endif %}
  </h2>

  <!-- Datos de la factura -->
  <div class="mb-4">
    <strong>Folio:</strong> {{ factura.folio }}<br>
    <strong>Emisor:</strong> {{ factura.razon_social_emisor }}<br>
    <strong>Monto:</strong> ${{ '{:,.0f}'.format(factura.monto) }}<br>
    <strong>Vencimiento:</strong> {{ factura.fecha_vencimiento }}
  </div>

  <!-- Formulario de oferta -->
  {% if oferta is defined %}
    <form method="post" action="/financiador/actualizar-oferta/{{ oferta.id }}">
  {% else %}
    <form method="post" action="/financiador/registrar-oferta/{{ factura.folio }}">
  {% endif %}
    
    <div class="mb-3">
      <label for="tasa_interes" class="form-label">Tasa de interés (%)</label>
      <input type="number"
             step="0.01"
             name="tasa_interes"
             id="tasa_interes"
             value="{{ oferta.tasa_interes if oferta is defined }}"
             required
             class="form-control">
    </div>

    <div class="mb-3">
      <label for="comision_flat" class="form-label">Comisión flat ($)</label>
      <input type="number"
             step="0.01"
             name="comision_flat"
             id="comision_flat"
             value="{{ oferta.comision_flat if oferta is defined }}"
             required
             class="form-control">
    </div>

    <div class="mb-3">
      <label class="form-label">Días de anticipación</label>
      <input type="number"
             value="{{ dias_anticipacion }}"
             readonly
             class="form-control">
      <input type="hidden"
             name="dias_anticipacion"
             value="{{ dias_anticipacion }}">
    </div>

    <button type="submit" class="btn btn-primary">
      {% if oferta is defined %}Guardar cambios{% else %}Registrar Oferta{% endif %}
    </button>
    <a href="/financiador/marketplace" class="btn btn-secondary">Cancelar</a>
  </form>
</div>
{% endblock %}