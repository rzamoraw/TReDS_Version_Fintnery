{% extends "base.html" %}

{% block title %}Ofertar sobre Factura{% endblock %}

{% block content %}
<div class="container mt-5">
  <h2>
    {% if oferta is defined %}Editar oferta{% else %}Ofertar sobre Factura{% endif %}
  </h2>

  <!-- Datos fijos de la factura -->
  <div class="mb-3">
    <strong>Folio:</strong> {{ factura.folio }}<br>
    <strong>Emisor:</strong> {{ factura.razon_social_emisor }}<br>
    <strong>Monto:</strong> ${{ '{:,.0f}'.format(factura.monto) }}<br>
    <strong>Vencimiento:</strong> {{ factura.fecha_vencimiento }}
  </div>

  {# ----------  FORMULARIO  ----------- #}
  {% if oferta is defined %}
    <!-- Modo edición -->
    <form method="post" action="/financiador/actualizar-oferta/{{ oferta.id }}">
  {% else %}
    <!-- Modo creación -->
    <form method="post" action="/financiador/registrar-oferta/{{ factura.id }}">
  {% endif %}

      <!-- Tasa interés -->
      <div class="mb-3">
        <label for="tasa_interes" class="form-label">Tasa de interés (%)</label>
        <input type="number"
               step="0.01"
               name="tasa_interes"
               id="tasa_interes"
               value="{{ oferta.tasa_interes if oferta is defined }}"
               required
               class="form-control">
      </div>

      <!-- Comisión flat -->
      <div class="mb-3">
        <label for="comision_flat" class="form-label">Comisión flat (monto)</label>
        <input type="number"
               step="0.01"
               name="comision_flat"
               id="comision_flat"
               value="{{ oferta.comision_flat if oferta is defined }}"
               required
               class="form-control">
      </div>

      <!-- Días anticipación: visible pero no editable -->
      <div class="mb-3">
        <label class="form-label">Días de anticipación</label>
        <input type="number"
               value="{{ dias_anticipacion }}"
               readonly
               class="form-control">
        <!-- hidden para enviar el dato -->
        <input type="hidden"
               name="dias_anticipacion"
               value="{{ dias_anticipacion }}">
      </div>

      <button type="submit" class="btn btn-primary">
        {% if oferta is defined %}Guardar cambios{% else %}Registrar Oferta{% endif %}
      </button>
      <a href="/financiador/marketplace" class="btn btn-secondary">Cancelar</a>
  </form>
</div>
{% endblock %}
