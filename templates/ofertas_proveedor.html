{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
  <h2>Ofertas recibidas — Factura {{ factura.folio }}</h2>
  <p><strong>Monto:</strong> ${{ '{:,.0f}'.format(factura.monto) }} |
     <strong>Vencimiento:</strong> {{ factura.fecha_vencimiento }}</p>

  {% if ofertas %}
  <div class="table-responsive">
    <table class="table table-bordered table-hover mt-4 bg-white">
      <thead class="table-light">
        <tr>
          <th>Fondo</th>
          <th>Financiador</th>
          <th>Tasa interés (%)</th>
          <th>Comisión flat ($)</th>
          <th>Días anticipación</th>
          <th>Acción</th>
        </tr>
      </thead>
      <tbody>
        {% for oferta in ofertas %}
        <tr>
          <td>{{ oferta.financiador.fondo.nombre }}</td>
          <td>{{ oferta.financiador.nombre }}</td>
          <td>{{ '%.2f' % oferta.tasa_interes }}</td>
          <td>${{ '{:,.0f}'.format(oferta.comision_flat) }}</td>
          <td>{{ oferta.dias_anticipacion }}</td>
          <td>
            {% if factura.estado_dte != "Confirming adjudicado" %}
            <form method="post" action="/proveedor/adjudicar-oferta/{{ oferta.id }}">
              <button class="btn btn-sm btn-success">Adjudicar</button>
            </form>
            {% else %}
            <span class="text-muted">Adjudicada</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
    <div class="alert alert-info mt-4">
      No se han recibido ofertas aún para esta factura.
    </div>
  {% endif %}

  <a href="/proveedor" class="btn btn-outline-secondary mt-3">Volver a mis facturas</a>
</div>
{% endblock %}